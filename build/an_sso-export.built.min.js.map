{"version":3,"sources":["an_sso.src.cf.js"],"names":["AsmodeeNet","indexOf","acceptableLocales","access_hash","access_token","authorized","baseLinkAction","catHashCheck","checkDisplayOptions","checkErrors","checkLogoutRedirect","checkTokens","checkUrlOptions","clearItems","code","default_settings","disconnect","discovery_obj","getCryptoValue","getItem","getLocation","getPopup","iFrame","id_token","identity_obj","jwks","nonce","oauth","oauthiframe","oauthpopup","popupIframeWindowName","removeItem","setCookie","setItem","settings","signinCallback","state","try_refresh_name","base_is_host","base_is_path","logout_endpoint","base_url","client_id","redirect_uri","cancel_uri","logout_redirect_uri","callback_post_logout_redirect","base_uri_for_iframe","scope","response_type","display","display_options","iframe_css","callback_signin_success","console","log","arguments","callback_signin_error","error","element","receiveMessageCallback","saveOptions","crypto","key","res","rnd","value","window","msCrypto","getRandomValues","Uint8Array","Math","random","constructor","Array","forEach","r","push","toString","hasOwnProperty","join","slice","callback","signIn","location","reload","options","assign","path","width","height","windowName","windowOptions","this","_oauthWindow","open","that","autoclose","_oauthAutoCloseInterval","setInterval","close","clearInterval","_oauthInterval","closed","document","getElementById","replace","getElementsByClassName","name","src","focus","removeEventListener","e","currentTarget","contentWindow","contentDocument","addEventListener","access_hash_clt","b_hash","bcode","mdHex","KJUR","Util","sha256","substr","length","verifyBHash","btoa","hash","alg","errdecode","it_dec","it_head","j","len","jwt_decode","header","error1","search","_typeof","typ","URI","iss","normalize","aud","isArray","id_dec","exp","limit_exp_time","at_hash","c_hash","jws","JWS","verify","KEYUTIL","getKey","u","protocol","host","found_state","RegExp","test","href","createElement","endpoint","gameThis","k","locale","localizedEndpoint","ref","ruri","urlParsed","v","extend","success","pathname","encodeURI","redirect_extra","Object","keys","item","len1","m","splitted","t","split","token_type","expires","identity","parseInt","status","error_description","opt","ref1","tmpopts","noheader","nofooter","lnk2bt","leglnk","cookies","call","secondes","date","Date","setTime","getTime","toGMTString","cookie","c","ca","i","nameEQ","charAt","substring","cookieBase","pathBits","results","encodeURIComponent","d","results1","pop","minutes","store","set","get","remove","clearAll","init","baseSettings","crossDomain","dataType","headers","Authorization","Accept","isConnected","getAccessToken","getIdToken","getAccessHash","getDiscovery","getCode","getCheckErrors","isJwksDone","getConfiguredScope","getConfiguredAPI","getClientId","getSettings","getIdentity","getScopes","getExpires","getExpiresDate","auth_endpoint","authorization_endpoint","ident_endpoint","userinfo_endpoint","ajaxq","type","url","sets","auth","ajax","post","update","delete","discover","host_port","data","JSON","parse","issuer","end_session_endpoint","getJwks","jwks_uri","statusText","signUp","special_host","special_path","resetPass","context","xhr","restoreTokens","saved_access_token","saved_id_token","already_try_refresh","decoded","call_identity","undefined","cbdone","clear_before_refresh","saved_identity","setTimeout","setAccessToken","setIdToken","save_id_token","signOut","id_token_hint","logout_ep","successCallback","force","trackCb","closeit","inIframe","self","top","args","complete","defaultSettings","emptyFunction","mimeTypes","readyStateChange","cache","application/json","text/html","text/plain","floor","mime","result","readyState","getResponseHeader","responseText","message","XMLHttpRequest","attachEvent","Content-type","X-Requested-With","setRequestHeader","send","obj","ret","prototype","now","toPrecision","token","deco","headerObj","payloadObj"],"mappings":"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","file":"an_sso-export.built.min.js","sourcesContent":["(function() {\n  var AsmodeeNet, ajaxCl,\n    indexOf = [].indexOf;\n\n  ajaxCl = function(url, settings) {\n    var args, complete, defaultSettings, emptyFunction, error, key, mimeTypes, readyStateChange, success, xhr;\n    args = arguments;\n    settings = args.length === 1 ? args[0] : args[1];\n    emptyFunction = function() {\n      return null;\n    };\n    defaultSettings = {\n      url: args.length === 2 && (typeof url === 'string') ? url : '.',\n      cache: true,\n      data: {},\n      headers: {},\n      context: null,\n      type: 'GET',\n      success: emptyFunction,\n      error: emptyFunction,\n      complete: emptyFunction\n    };\n    settings = this.extend(defaultSettings, settings || {});\n    mimeTypes = {\n      'application/json': 'json',\n      'text/html': 'html',\n      'text/plain': 'text'\n    };\n    if (!settings.cache) {\n      settings.url = settings.url + (settings.url.indexOf('?') ? '&' : '?') + 'noCache=' + Math.floor(Math.random() * 9e9);\n    }\n    success = function(data, xhr, settings) {\n      var status;\n      status = 'success';\n      settings.success.call(settings.context, data, status, xhr);\n      return complete(status, xhr, settings);\n    };\n    error = function(error, type, xhr, settings) {\n      settings.error.call(settings.context, xhr, type, error);\n      return complete(type, xhr, settings);\n    };\n    complete = function(status, xhr, settings) {\n      return settings.complete.call(settings.context, xhr, status);\n    };\n    xhr = new XMLHttpRequest();\n    readyStateChange = function() {\n      var dataType, e, mime, result;\n      if (xhr.readyState === 4) {\n        result = null;\n        mime = xhr.getResponseHeader('content-type');\n        dataType = mimeTypes[mime] || 'text';\n        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304) {\n          result = xhr.responseText;\n          try {\n            if (dataType === 'json') {\n              result = JSON.parse(result);\n            }\n          } catch (error1) {\n            e = error1;\n            error(e.message, 'parsererror', xhr, settings);\n            return;\n          }\n          success(result, xhr, settings);\n          return;\n        } else {\n          result = xhr.responseText;\n          try {\n            if (dataType === 'json') {\n              result = JSON.parse(result);\n            }\n            error(result, 'error', xhr, settings);\n            return;\n          } catch (error1) {\n            e = error1;\n            error(e.message, 'parsererror', xhr, settings);\n            return;\n          }\n        }\n        return error(result, 'error', xhr, settings);\n      }\n    };\n    if (xhr.addEventListener) {\n      xhr.addEventListener('readystatechange', readyStateChange, false);\n    } else if (xhr.attachEvent) {\n      xhr.attachEvent('onreadystatechange', readyStateChange);\n    }\n    xhr.open(settings.type, settings.url);\n    if (settings.type === 'POST') {\n      settings.headers = this.extend({\n        'Content-type': 'application/x-www-form-urlencoded'\n      }, settings.headers, {\n        'X-Requested-With': 'XMLHttpRequest'\n      });\n    }\n    for (key in settings.headers) {\n      xhr.setRequestHeader(key, settings.headers[key]);\n    }\n    xhr.send(settings.data);\n    return this;\n  };\n\n  AsmodeeNet = (function() {\n    var _oauthWindow, acceptableLocales, access_hash, access_token, authorized, baseLinkAction, catHashCheck, checkDisplayOptions, checkErrors, checkLogoutRedirect, checkTokens, checkUrlOptions, clearCookies, clearItems, code, defaultErrorCallback, defaultSuccessCallback, default_settings, deleteCookie, disconnect, discovery_obj, getCookie, getCryptoValue, getItem, getLocation, getPopup, iFrame, id_token, identity_obj, jwks, localStorageIsOk, nonce, oauth, oauthiframe, oauthpopup, popupIframeWindowName, removeItem, setCookie, setItem, settings, signinCallback, state, try_refresh_name;\n    defaultSuccessCallback = function() {\n      return console.log(arguments);\n    };\n    defaultErrorCallback = function() {\n      return console.error(arguments);\n    };\n    acceptableLocales = ['fr', 'de', 'en', 'it', 'es'];\n    default_settings = {\n      base_is_host: 'https://account.asmodee.net',\n      base_is_path: '/main/v2/oauth',\n      logout_endpoint: '/main/v2/logout',\n      base_url: 'https://api.asmodee.net/main/v1',\n      client_id: null,\n      redirect_uri: null,\n      cancel_uri: null, // Only used in touch mode by the IS\n      logout_redirect_uri: null, // if not provided, and not configured in Studio manager for this app, the IS will redirect the user on IS page only!\n      callback_post_logout_redirect: null, // the only one solution for callback success in 'page' or 'touch' display mode\n      base_uri_for_iframe: null,\n      scope: 'openid+profile',\n      response_type: 'id_token token',\n      display: 'popup',\n      display_options: {},\n      iframe_css: null, // only used un 'iframe' display mode\n      callback_signin_success: defaultSuccessCallback, // the only one solution for callback success in 'page' or 'touch' display mode\n      callback_signin_error: defaultErrorCallback // the only one solution for callback error in 'page' or 'touch' display mode\n    };\n    settings = {};\n    state = nonce = null;\n    access_token = id_token = access_hash = identity_obj = discovery_obj = jwks = code = null;\n    checkErrors = [];\n    localStorageIsOk = null;\n    popupIframeWindowName = 'AsmodeeNetConnectWithOAuth';\n    try_refresh_name = 'try_refresh';\n    _oauthWindow = null;\n    iFrame = {\n      element: null,\n      receiveMessageCallback: null,\n      saveOptions: null\n    };\n    getCryptoValue = function() {\n      var crypto, key, res, rnd, value;\n      crypto = window.crypto || window.msCrypto;\n      rnd = 0;\n      res = [];\n      if (crypto) {\n        rnd = crypto.getRandomValues(new Uint8Array(30));\n      } else {\n        rnd = [Math.random()];\n      }\n      if (rnd.constructor === Array) {\n        rnd.forEach(function(r) {\n          return res.push(r.toString(36));\n        });\n      } else {\n        for (key in rnd) {\n          value = rnd[key];\n          if (rnd.hasOwnProperty(key)) {\n            res.push(value.toString(36));\n          }\n        }\n      }\n      return (res.join('') + '00000000000000000').slice(2, 16 + 2);\n    };\n    disconnect = function(callback) {\n      if (callback == null) {\n        callback = false;\n      }\n      clearItems();\n      access_token = id_token = access_hash = identity_obj = code = null;\n      if (callback) {\n        callback();\n        if (settings.display === 'iframe') {\n          return AsmodeeNet.signIn(iFrame.saveOptions);\n        }\n      } else {\n        return window.location.reload();\n      }\n    };\n    oauth = function(options) {\n      if (settings.display === 'popup') {\n        return oauthpopup(options);\n      } else if (settings.display === 'iframe') {\n        return oauthiframe(options);\n      } else {\n        return window.location.assign(options.path);\n      }\n    };\n    getPopup = function(options) {\n      if (options.width == null) {\n        options.width = 475;\n      }\n      if (options.height == null) {\n        options.height = 500;\n      }\n      if (options.windowName == null) {\n        options.windowName = popupIframeWindowName;\n      }\n      if (options.windowOptions == null) {\n        options.windowOptions = 'location=0,status=0,width=' + options.width + ',height=' + options.height;\n      }\n      if (options.callback == null) {\n        options.callback = function() {\n          return window.location.reload();\n        };\n      }\n      return this._oauthWindow = window.open(options.path, options.windowName, options.windowOptions);\n    };\n    oauthpopup = function(options) {\n      var that;\n      getPopup(options);\n      that = this;\n      if (options.autoclose) {\n        that._oauthAutoCloseInterval = window.setInterval(function() {\n          that._oauthWindow.close();\n          delete that._oauthWindow;\n          if (that._oauthAutoCloseInterval) {\n            window.clearInterval(that._oauthAutoCloseInterval);\n          }\n          if (that._oauthInterval) {\n            window.clearInterval(that._oauthInterval);\n          }\n          return options.callback();\n        }, 500);\n      }\n      return that._oauthInterval = window.setInterval(function() {\n        if (that._oauthWindow.closed) {\n          if (that._oauthInterval) {\n            window.clearInterval(that._oauthInterval);\n          }\n          if (that._oauthAutoCloseInterval) {\n            window.clearInterval(that._oauthAutoCloseInterval);\n          }\n          return options.callback();\n        }\n      }, 1000);\n    };\n    oauthiframe = function(options) {\n      var redirect_uri;\n      if (options.width == null) {\n        options.width = 475;\n      }\n      if (options.height == null) {\n        options.height = 500;\n      }\n      if (options.callback == null) {\n        options.callback = function() {\n          return window.location.reload();\n        };\n      }\n      iFrame.element = settings.iframe_css.indexOf('#') !== -1 ? window.document.getElementById(settings.iframe_css.replace('#', '')) : window.document.getElementsByClassName(settings.iframe_css)[0];\n      if (iFrame.element) {\n        iFrame.element.name = popupIframeWindowName;\n        iFrame.element.width = options.width;\n        iFrame.element.height = options.height;\n        iFrame.element.src = options.path;\n        redirect_uri = settings.redirect_uri;\n        if (iFrame.element && !iFrame.element.closed) {\n          iFrame.element.focus();\n        }\n        if (iFrame.receiveMessageCallback) {\n          iFrame.element.removeEventListener('load', iFrame.receiveMessageCallback);\n        }\n        iFrame.receiveMessageCallback = function(e) {\n          var d, item;\n          if (e.currentTarget.name === popupIframeWindowName) {\n            d = e.currentTarget.contentWindow || e.currentTarget.contentDocument;\n            item = getItem('gd_connect_hash');\n            if (item) {\n              return options.callback();\n            }\n          }\n        };\n        return iFrame.element.addEventListener('load', iFrame.receiveMessageCallback, false);\n      }\n    };\n    authorized = function(access_hash_clt) {\n      access_hash = access_hash_clt;\n      access_token = access_hash.access_token;\n      id_token = access_hash.id_token;\n      if (access_hash.code) {\n        return code = access_hash.code;\n      }\n    };\n    catHashCheck = function(b_hash, bcode) {\n      var mdHex;\n      mdHex = KJUR.crypto.Util.sha256(bcode);\n      mdHex = mdHex.substr(0, mdHex.length / 2);\n      while (!(b_hash.length % 4 === 0)) {\n        b_hash += '=';\n      }\n      window.AsmodeeNet.verifyBHash(b_hash);\n      return b_hash === btoa(mdHex);\n    };\n    checkTokens = function(nonce, hash) {\n      var alg, at_dec, at_head, e, errdecode, it_dec, it_head, j, key, len;\n      if (hash.access_token) {\n        try {\n          at_dec = jwt_decode(hash.access_token);\n          at_head = jwt_decode(hash.access_token, {\n            header: true\n          });\n        } catch (error1) {\n          errdecode = error1;\n          checkErrors.push(\"access_token decode error : \" + errdecode);\n          return false;\n        }\n      }\n      if (settings.response_type.search('id_token') >= 0) {\n        if (typeof hash.id_token === void 0) {\n          return false;\n        }\n        try {\n          it_dec = jwt_decode(hash.id_token);\n          it_head = jwt_decode(hash.id_token, {\n            header: true\n          });\n        } catch (error1) {\n          errdecode = error1;\n          checkErrors.push(\"id_token decode error : \" + errdecode);\n          return false;\n        }\n        if (it_head.typ !== 'JWT') {\n          checkErrors.push('Invalid type');\n          return false;\n        }\n        if (it_head.alg !== 'RS256') {\n          checkErrors.push('Invalid alg');\n          return false;\n        }\n        if (nonce && (it_dec.nonce !== nonce)) {\n          checkErrors.push('Invalid nonce');\n          return false;\n        }\n        if (URI(it_dec.iss).normalize().toString() !== URI(settings.base_is_host).normalize().toString()) {\n          checkErrors.push('Invalid issuer');\n          return false;\n        }\n        if (it_dec.aud !== settings.client_id && (!Array.isArray(it_dec.aud) || id_dec.aud.indexOf(settings.client_id) === -1)) {\n          checkErrors.push('Invalid auditor');\n          return false;\n        }\n        if (it_dec.exp < window.AsmodeeNet.limit_exp_time()) {\n          checkErrors.push('Invalid expiration date');\n          return false;\n        }\n        if (typeof it_dec.at_hash === 'string' && !catHashCheck(it_dec.at_hash, hash.access_token)) {\n          checkErrors.push('Invalid at_hash');\n          return false;\n        }\n        if (hash.code && typeof it_dec.c_hash === 'string' && !catHashCheck(it_dec.c_hash, hash.code)) {\n          checkErrors.push('Invalid c_hash');\n          return false;\n        }\n        alg = [it_head.alg];\n        for (j = 0, len = jwks.length; j < len; j++) {\n          key = jwks[j];\n          if (key.alg && key.alg === alg[0]) {\n            try {\n              if (KJUR.jws.JWS.verify(hash.id_token, KEYUTIL.getKey(key), alg)) {\n                return true;\n              }\n            } catch (error1) {\n              e = error1;\n              console.error('JWS verify error', e);\n            }\n          }\n        }\n        checkErrors.push('Invalid JWS key');\n        return false;\n      }\n      return true;\n    };\n    checkUrlOptions = function() {\n      var u;\n      if (settings.base_is_host) {\n        u = URI(settings.base_is_host);\n        settings.base_is_host = u.protocol() + '://' + u.host();\n      }\n      if (settings.base_url) {\n        settings.base_url = URI(settings.base_url).normalize().toString();\n      }\n      if (settings.logout_redirect_uri) {\n        return settings.logout_redirect_uri = URI(settings.logout_redirect_uri).normalize().toString();\n      }\n    };\n    checkLogoutRedirect = function() {\n      var found_state, re;\n      if (settings.logout_redirect_uri) {\n        re = new RegExp(settings.logout_redirect_uri.replace(/([?.+*()])/g, \"\\\\$1\"));\n        if (re.test(window.location.href) && settings.display !== 'iframe') {\n          found_state = window.location.href.replace(settings.logout_redirect_uri + '&state=', '').replace(/[&#].*$/, '');\n          if ((found_state === getItem('logout_state')) || (!found_state && !getItem('logout_state'))) {\n            removeItem('logout_state');\n            if (settings.callback_post_logout_redirect) {\n              return settings.callback_post_logout_redirect();\n            } else {\n              return window.location = '/';\n            }\n          }\n        }\n      }\n    };\n    getLocation = function(href) {\n      var l;\n      l = document.createElement(\"a\");\n      return l.href = href;\n    };\n    baseLinkAction = function(that, endpoint, options) {\n      var gameThis, k, locale, localizedEndpoint, ref, ruri, urlParsed, v;\n      options = options || {};\n      locale = options.locale ? '/' + options.locale : '';\n      if (locale !== '' && acceptableLocales.indexOf(locale) === -1) {\n        locale = 'en';\n      }\n      if (settings.display === 'iframe') {\n        iFrame.saveOptions = AsmodeeNet.extend({}, options);\n      }\n      state = getCryptoValue();\n      nonce = getCryptoValue();\n      setItem('state', state, settings.display === 'iframe' ? 1440 : 20);\n      setItem('nonce', nonce, settings.display === 'iframe' ? 1440 : 20);\n      settings.callback_signin_success = options.success || settings.callback_signin_success;\n      settings.callback_signin_error = options.error || settings.callback_signin_error;\n      urlParsed = getLocation(endpoint);\n      localizedEndpoint = endpoint.replace(urlParsed.pathname, options.locale + urlParsed.pathname);\n      options.path = localizedEndpoint + '?display=' + settings.display + '&response_type=' + encodeURI(settings.response_type) + '&state=' + state + '&client_id=' + settings.client_id + '&scope=' + settings.scope;\n      if (settings.redirect_uri) {\n        ruri = settings.redirect_uri;\n        if (options.redirect_extra) {\n          ruri += options.redirect_extra;\n        }\n        options.path += '&redirect_uri=' + encodeURI(ruri);\n      }\n      if (settings.response_type.search('id_token') >= 0) {\n        options.path += '&nonce=' + nonce;\n      }\n      if (Object.keys(settings.display_options).length > 0) {\n        ref = settings.display_options;\n        for (k in ref) {\n          v = ref[k];\n          options.path += '&display_opts[' + k + ']=' + (v ? '1' : '0');\n        }\n      }\n      if (settings.cancel_uri) {\n        options.path += '&cancel_uri=' + encodeURI(settings.cancel_uri);\n      }\n      gameThis = that;\n      options.callback = function() {\n        removeItem(try_refresh_name);\n        return signinCallback(gameThis);\n      };\n      return oauth(options);\n    };\n    signinCallback = function(gameThis) {\n      var hash, item, j, len, len1, m, splitted, t;\n      item = getItem('gd_connect_hash');\n      if (!item) {\n        if (settings.display === 'popup') {\n          return settings.callback_signin_error(\"popup closed without signin\");\n        }\n      } else {\n        removeItem('gd_connect_hash');\n        hash = {};\n        splitted = null;\n        if (item.search(/^#/) === 0) {\n          splitted = item.replace(/^#/, '').split('&');\n          for (j = 0, len = splitted.length; j < len; j++) {\n            t = splitted[j];\n            t = t.split('=');\n            hash[t[0]] = t[1];\n          }\n          if (hash.token_type && hash.token_type === 'bearer') {\n            state = getItem('state');\n            nonce = getItem('nonce');\n            if (hash.state) {\n              if (hash.state === state) {\n                hash.scope = hash.scope.split('+');\n                hash.expires = jwt_decode(hash.access_token)['exp'];\n                checkErrors = [];\n                if (checkTokens(nonce, hash)) {\n                  removeItem('state');\n                  removeItem('nonce');\n                  authorized(hash);\n                  return gameThis.identity({\n                    success: settings.callback_signin_success,\n                    error: settings.callback_signin_error\n                  });\n                } else {\n                  return settings.callback_signin_error('Tokens validation issue : ', checkErrors);\n                }\n              } else {\n                return settings.callback_signin_error('Tokens validation issue : ', 'Invalid state');\n              }\n            }\n          }\n        } else if (item.search(/^\\?/) === 0) {\n          splitted = item.replace(/^\\?/, '').split('&');\n          for (m = 0, len1 = splitted.length; m < len1; m++) {\n            t = splitted[m];\n            t = t.split('=');\n            hash[t[0]] = t[1];\n          }\n          state = getItem('state');\n          removeItem('state');\n          if (hash.state && hash.state === state) {\n            return settings.callback_signin_error(parseInt(hash.status), hash.error, hash.error_description.replace(/\\+/g, ' '));\n          }\n        }\n      }\n    };\n    checkDisplayOptions = function() {\n      var opt, ref, ref1, tmpopts, val;\n      tmpopts = null;\n      if ((ref = settings.display) === 'touch' || ref === 'iframe') {\n        tmpopts = {\n          noheader: true,\n          nofooter: true,\n          lnk2bt: true,\n          leglnk: false,\n          cookies: true\n        };\n      } else if (settings.display === 'popup') {\n        tmpopts = {\n          noheader: false,\n          nofooter: false,\n          lnk2bt: false,\n          leglnk: true\n        };\n      }\n      if (Object.keys(settings.display_options).length > 0) {\n        if (tmpopts) {\n          ref1 = settings.display_options;\n          for (opt in ref1) {\n            val = ref1[opt];\n            if (indexOf.call(Object.keys(tmpopts), opt) < 0) {\n              delete settings.display_options[opt];\n            }\n          }\n        }\n      }\n      settings.display_options = AsmodeeNet.extend(tmpopts, settings.display_options);\n      if (indexOf.call(Object.keys(settings.display_options), 'cookies') >= 0 && settings.display_options.cookies === true) {\n        delete settings.display_options.cookies;\n      }\n      if (settings.display === 'touch') {\n        if (!settings.cancel_uri) {\n          return settings.cancel_uri = settings.redirect_uri;\n        }\n      }\n    };\n    setCookie = function(name, value, secondes) {\n      var date, expires;\n      if (secondes) {\n        date = new Date();\n        date.setTime(date.getTime() + (secondes * 1000));\n        expires = \"; expires=\" + date.toGMTString();\n      } else {\n        expires = \"\";\n      }\n      return document.cookie = name + \"=\" + value + expires + \"; path=/\";\n    };\n    getCookie = function(name) {\n      var c, ca, i, nameEQ;\n      nameEQ = name + \"=\";\n      ca = document.cookie.split(\";\");\n      i = 0;\n      while (i < ca.length) {\n        c = ca[i];\n        while (c.charAt(0) === \" \") {\n          c = c.substring(1, c.length);\n        }\n        if (c.indexOf(nameEQ) === 0) {\n          return c.substring(nameEQ.length, c.length);\n        }\n        i++;\n      }\n      return null;\n    };\n    deleteCookie = function(name) {\n      return setCookie(name, \"\", -1);\n    };\n    clearCookies = function() {\n      var cookie, cookieBase, cookies, j, len, pathBits, results;\n      cookies = document.cookie.split('; ');\n      results = [];\n      for (j = 0, len = cookies.length; j < len; j++) {\n        cookie = cookies[j];\n        cookieBase = encodeURIComponent(cookie.split(\";\")[0].split(\"=\")[0]) + '=; expires=Thu, 01-Jan-1970 00:00:01 GMT; domain=' + d.join('.') + ' ;path=';\n        pathBits = location.pathname.split('/');\n        results.push((function() {\n          var results1;\n          results1 = [];\n          while (pathBits.length > 0) {\n            document.cookie = cookieBase + pathBits.join('/');\n            results1.push(pathBits.pop());\n          }\n          return results1;\n        })());\n      }\n      return results;\n    };\n    setItem = function(name, value, minutes) {\n      var error;\n      try {\n        return store.set(name, value, new Date().getTime() + (minutes * 60000));\n      } catch (error1) {\n        error = error1;\n        return console.error(\"SetItem '\" + name + \"'\", value, error);\n      }\n    };\n    getItem = function(name) {\n      var error;\n      try {\n        return store.get(name);\n      } catch (error1) {\n        error = error1;\n        console.error(\"GetItem '\" + name + \"'\", error);\n        return null;\n      }\n    };\n    removeItem = function(name) {\n      return store.remove(name);\n    };\n    clearItems = function() {\n      return store.clearAll();\n    };\n    return {\n      verifyBHash: function(b_hash) {\n        return b_hash; // internal use for tests\n      },\n      init: function(options) {\n        settings = this.extend(default_settings, options);\n        checkUrlOptions();\n        checkDisplayOptions();\n        checkLogoutRedirect();\n        return this;\n      },\n      baseSettings: function() {\n        return {\n          crossDomain: true,\n          dataType: 'json',\n          headers: {\n            'Authorization': 'Bearer ' + access_token,\n            'Accept': 'application/json'\n          }\n        };\n      },\n      isConnected: function() {\n        return this.getAccessToken() !== null;\n      },\n      getAccessToken: function() {\n        return access_token;\n      },\n      getIdToken: function() {\n        return id_token;\n      },\n      getAccessHash: function() {\n        return access_hash;\n      },\n      getDiscovery: function() {\n        return discovery_obj;\n      },\n      getCode: function() {\n        return code;\n      },\n      getCheckErrors: function() {\n        return checkErrors;\n      },\n      isJwksDone: function() {\n        return jwks !== null;\n      },\n      getConfiguredScope: function() {\n        return settings.scope;\n      },\n      getConfiguredAPI: function() {\n        return settings.base_url;\n      },\n      getClientId: function() {\n        return settings.client_id;\n      },\n      getSettings: function() {\n        return this.extend({}, settings);\n      },\n      getIdentity: function() {\n        return identity_obj;\n      },\n      getScopes: function() {\n        if (!this.isConnected()) {\n          return null;\n        }\n        return this.getAccessHash()['scope'];\n      },\n      getExpires: function() {\n        if (!this.isConnected()) {\n          return null;\n        }\n        return this.getAccessHash()['expires'];\n      },\n      getExpiresDate: function() {\n        if (!this.isConnected()) {\n          return null;\n        }\n        return new Date(this.getAccessHash()['expires'] * 1000);\n      },\n      auth_endpoint: function() {\n        if (discovery_obj) {\n          return URI(discovery_obj.authorization_endpoint).normalize().toString();\n        }\n        return URI(settings.base_is_host + settings.base_is_path + '/authorize').normalize().toString();\n      },\n      ident_endpoint: function() {\n        if (discovery_obj) {\n          return URI(discovery_obj.userinfo_endpoint).normalize().toString();\n        }\n        return URI(settings.base_is_host + settings.base_is_path + '/identity').normalize().toString();\n      },\n      ajaxq: function(type, url, options) {\n        var base_url, sets;\n        if (options == null) {\n          options = {};\n        }\n        base_url = options.base_url || settings.base_url || default_settings.base_url;\n        delete options.base_url;\n        sets = this.extend(options, this.baseSettings(), {\n          type: type\n        });\n        if (options.auth !== void 0 && options.auth === false) {\n          if (sets.headers.Authorization) {\n            delete sets.headers.Authorization;\n          }\n          delete sets.auth;\n        }\n        return this.ajax(base_url + url, sets);\n      },\n      get: function(url, options) {\n        return this.ajaxq('GET', url, options);\n      },\n      post: function(url, options) {\n        return this.ajaxq('POST', url, options);\n      },\n      update: function(url, options) {\n        return this.ajaxq('PUT', url, options);\n      },\n      delete: function(url, options) {\n        return this.ajaxq('DELETE', url, options);\n      },\n      discover: function(host_port) {\n        var gameThis;\n        host_port = host_port || settings.base_is_host || default_settings.base_is_host;\n        host_port = URI(host_port);\n        host_port = host_port.protocol() + '://' + host_port.host();\n        gameThis = this;\n        return this.get('/.well-known/openid-configuration', {\n          base_url: host_port,\n          auth: false,\n          success: function(data) {\n            if (typeof data === 'object') {\n              discovery_obj = data;\n            } else {\n              discovery_obj = JSON.parse(data);\n            }\n            settings.base_is_host = URI(discovery_obj.issuer).normalize().toString();\n            settings.logout_endpoint = URI(discovery_obj.end_session_endpoint).normalize().toString();\n            return gameThis.getJwks();\n          },\n          error: function() {\n            return console.error(\"error Discovery on \" + host_port, arguments);\n          }\n        });\n      },\n      getJwks: function() {\n        var gameThis;\n        gameThis = this;\n        return this.get('', {\n          base_url: URI(discovery_obj.jwks_uri).normalize().toString(),\n          auth: false,\n          success: function(data) {\n            if (typeof data === 'object') {\n              jwks = data.keys;\n            } else {\n              jwks = JSON.parse(data).keys;\n            }\n            if (settings.display !== 'popup') {\n              return signinCallback(gameThis);\n            }\n          },\n          error: function() {\n            console.error(\"error JWKS\", arguments);\n            if (arguments.length > 0) {\n              console.error(\"error JWKS => \" + arguments[0]);\n            }\n            if (arguments.length > 0) {\n              return console.error(\"error JWKS => \" + arguments[0].statusText);\n            }\n          }\n        });\n      },\n      signUp: function(locale, options, special_host, special_path) {\n        if (acceptableLocales.indexOf(locale) === -1) {\n          locale = 'en';\n        }\n        if (!special_host) {\n          special_host = discovery_obj.issuer;\n        }\n        if (!special_path) {\n          special_path = '/signup';\n        }\n        return baseLinkAction(this, URI(special_host).normalize().toString() + locale + special_path, options);\n      },\n      resetPass: function(locale, options, special_host, special_path) {\n        if (acceptableLocales.indexOf(locale) === -1) {\n          locale = 'en';\n        }\n        if (!special_host) {\n          special_host = discovery_obj.issuer;\n        }\n        if (!special_path) {\n          special_path = '/reset';\n        }\n        return baseLinkAction(this, URI(discovery_obj.issuer).normalize().toString() + locale + special_path, options);\n      },\n      signIn: function(options, special_host, special_path) {\n        if (special_host) {\n          special_host = URI(special_host).normalize().toString() + locale + special_path;\n        } else {\n          special_host = this.auth_endpoint();\n        }\n        return baseLinkAction(this, special_host, options);\n      },\n      identity: function(options) {\n        if (!this.isConnected()) {\n          if (options && options.error) {\n            options.error('Identity error. Not connected', null, null, 'Not Connected');\n          } else {\n            console.error('identity error', 'You\\'re not connected');\n          }\n          return false;\n        }\n        if (this.isConnected() && identity_obj) {\n          if (settings.display === 'iframe') {\n            iFrame.element.src = '';\n          }\n          if (options && options.success) {\n            return options.success(identity_obj, AsmodeeNet.getCode());\n          }\n        } else {\n          return this.get('', {\n            base_url: this.ident_endpoint(),\n            success: function(data) {\n              identity_obj = data;\n              if (settings.display === 'iframe') {\n                iFrame.element.src = '';\n              }\n              if (options && options.success) {\n                return options.success(identity_obj, AsmodeeNet.getCode());\n              }\n            },\n            error: function(context, xhr, type, error) {\n              if (options && options.error) {\n                return options.error(context, xhr, type, error);\n              } else {\n                return console.error('identity error', context, xhr, type, error);\n              }\n            }\n          });\n        }\n      },\n      restoreTokens: function(saved_access_token, saved_id_token, call_identity = true, cbdone = null, clear_before_refresh = null, saved_identity = null) {\n        var already_try_refresh, decoded, hash;\n        if (saved_access_token && access_token) {\n          saved_access_token = null;\n        }\n        if (saved_id_token && id_token) {\n          id_token = null;\n        }\n        if (saved_access_token) {\n          hash = {\n            access_token: saved_access_token,\n            id_token: saved_id_token\n          };\n          if (this.isJwksDone()) {\n            if (checkTokens(null, hash)) {\n              decoded = jwt_decode(saved_access_token);\n              hash.scope = decoded['scope'].split(' ');\n              hash.expires = decoded['exp'];\n              hash.token_type = decoded['token_type'];\n              removeItem(try_refresh_name);\n              authorized(hash);\n              if (call_identity) {\n                this.identity({\n                  success: settings.callback_signin_success,\n                  error: settings.callback_signin_error\n                });\n              }\n              if (saved_identity) {\n                identity_obj = saved_identity;\n              }\n              if (cbdone) {\n                cbdone(true);\n              } else {\n                return true;\n              }\n            } else {\n              already_try_refresh = getItem(try_refresh_name);\n              removeItem(try_refresh_name);\n              if (checkErrors[0] === 'Invalid expiration date' && clear_before_refresh && !already_try_refresh) {\n                console.log('try refresh token');\n                setItem(try_refresh_name, true);\n                clear_before_refresh() && AsmodeeNet.signIn({\n                  success: cbdone\n                });\n              } else {\n                if (cbdone) {\n                  cbdone(false, checkErrors);\n                } else {\n                  return false;\n                }\n              }\n            }\n          } else {\n            setTimeout(function() {\n              return AsmodeeNet.restoreTokens(saved_access_token, saved_id_token, call_identity, cbdone, clear_before_refresh, saved_identity);\n            }, 200);\n          }\n        }\n        return null;\n      },\n      setAccessToken: function(saved_access_token) {\n        return access_token = saved_access_token;\n      },\n      setIdToken: function(save_id_token) {\n        return id_token = save_id_token;\n      },\n      signOut: function(options) {\n        var id_token_hint, logout_ep, redirect_uri, successCallback;\n        successCallback = options && typeof options.success !== 'undefined' ? options.success : null;\n        if (this.isConnected() || options.force) {\n          if (settings.logout_redirect_uri) {\n            state = getCryptoValue();\n            id_token_hint = id_token;\n            setItem('logout_state', state, 5);\n            logout_ep = settings.logout_endpoint + '?post_logout_redirect_uri=' + encodeURI(settings.logout_redirect_uri) + '&state=' + state + '&id_token_hint=' + id_token_hint;\n            if (settings.display === 'iframe') {\n              if (iFrame.element) {\n                iFrame.element.src = logout_ep;\n                redirect_uri = settings.logout_redirect_uri;\n                if (iFrame.receiveMessageCallback) {\n                  iFrame.element.removeEventListener('load', iFrame.receiveMessageCallback);\n                }\n                iFrame.receiveMessageCallback = function(e) {\n                  if (e.currentTarget.name === popupIframeWindowName) {\n                    return disconnect(successCallback);\n                  }\n                };\n                return iFrame.element.addEventListener('load', iFrame.receiveMessageCallback, false);\n              }\n            } else if (settings.display === 'popup') {\n              options.path = logout_ep;\n              options.callback = function() {\n                return disconnect(successCallback);\n              };\n              return oauthpopup(options);\n            } else {\n              return window.location = logout_ep;\n            }\n          } else {\n            return disconnect(successCallback);\n          }\n        }\n      },\n      trackCb: function(closeit) {\n        if (closeit == null) {\n          closeit = true;\n        }\n        if (window.location.hash !== \"\") {\n          setItem('gd_connect_hash', window.location.hash, 5);\n        } else if (window.location.search !== \"\") {\n          setItem('gd_connect_hash', window.location.search, 5);\n        }\n        if (window.name === 'AsmodeeNetConnectWithOAuth') {\n          console.log('ok try closeit');\n          if (closeit) {\n            return window.close();\n          }\n        }\n      },\n      inIframe: function() {\n        return window.self === window.top;\n      }\n    };\n  });\n\n  AsmodeeNet.ajax = ajaxCl;\n\n  AsmodeeNet.extend = function() {\n    var j, key, len, obj, ret;\n    ret = {};\n    for (j = 0, len = arguments.length; j < len; j++) {\n      obj = arguments[j];\n      for (key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\n          ret[key] = obj[key];\n        }\n      }\n    }\n    return ret;\n  };\n\n  AsmodeeNet.limit_exp_time = function() {\n    return (Date.now() / 1000).toPrecision(10);\n  };\n\n  AsmodeeNet.jwt_decode = function(token, options) {\n    var deco;\n    deco = KJUR.jws.JWS.parse(token);\n    if (options && options.header !== \"undefined\" && options.header === true) {\n      return deco.headerObj;\n    }\n    return deco.payloadObj;\n  };\n\n  window.AsmodeeNet = AsmodeeNet();\n\n  if (typeof window.AN === 'undefined') {\n    window.AN = window.AsmodeeNet;\n  }\n\n  // For retro compatibility\n  if (typeof window.GamifyDigital === 'undefined') {\n    window.GamifyDigital = window.AsmodeeNet;\n  }\n\n  if (typeof window.GD === 'undefined') {\n    window.GD = window.AsmodeeNet;\n  }\n\n  if (!window.jwt_decode) {\n    window.jwt_decode = window.AsmodeeNet.jwt_decode;\n  }\n\n}).call(this);\n\n//# sourceMappingURL=an_sso.src.cf.js.map\n"]}